<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDX Dashboard - Mobile</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font family -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0e1116; /* Deep dark background */
            color: #e5e7eb; /* Light gray text */
            padding-bottom: 56px; /* Space for the fixed footer */
        }
        .main-container {
            min-height: 100vh;
        }
        .card {
            background-color: #1e2029;
            border: 1px solid #2d303a;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }
        .text-accent-red {
            color: #ef4444; /* Red-500 */
        }
        .text-accent-green {
            color: #10b981; /* Emerald-500 */
        }
        .active-link {
            border-bottom: 2px solid #3b82f6;
            color: white;
            font-weight: 600;
        }
        .trade-button-buy {
            background-image: linear-gradient(to right, #10b981, #047857);
        }
        .trade-button-sell {
            background-image: linear-gradient(to right, #ef4444, #b91c1c);
        }
        .trade-tab-active {
            background-color: #3b82f6;
            color: white;
        }
        /* Chart container styling for the realistic frame */
        .chart-frame {
            background-color: #181a20;
            border: 1px solid #2d303a;
            border-radius: 0.5rem;
            padding: 0.5rem 0.25rem 0.25rem 0.5rem; /* Adjust padding for axes */
            height: 400px; 
            overflow: hidden;
            position: relative;
        }
        #btc-chart {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* Sidebar Custom Styles */
        .sidebar {
            /* Full height, slightly less than full width */
            width: 75vw;
            max-width: 320px;
            /* Dark, distinct background */
            background-color: #1e2029;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.5);
            /* Slide from left */
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            z-index: 50; /* Above all content */
        }
        .sidebar.open {
            transform: translateX(0);
        }
        .sidebar-overlay {
            /* Fix for potential opacity issue in the previous version */
            transition: opacity 0.3s ease-in-out;
        }
        .sidebar-link {
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            font-size: 1rem;
            font-weight: 500;
            color: #e5e7eb;
            transition: background-color 0.15s;
            border-radius: 0.25rem;
        }
        .sidebar-link:hover {
            background-color: #2d303a;
        }
    </style>
</head>
<body class="antialiased">

    <!-- ---------------------------------------------------- -->
    <!-- SIDEBAR MENU (Hidden by default) -->
    <!-- ---------------------------------------------------- -->
    <aside id="sidebar-menu" class="fixed top-0 left-0 h-full sidebar">
        <div class="p-4 flex flex-col h-full">
            <div class="flex justify-between items-center pb-6 border-b border-gray-700">
                <span class="text-2xl font-extrabold text-[#3b82f6]">CDX Menu</span>
                <!-- Close Button -->
                <button onclick="toggleSidebar()" class="text-gray-400 hover:text-white transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>

            <!-- Navigation Links -->
            <nav class="mt-6 flex-grow space-y-1">
                <a href="#" onclick="showSection('home'); return false;" class="sidebar-link hover:text-[#3b82f6]">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Home
                </a>
                <a href="#" onclick="showSection('trade'); return false;" class="sidebar-link hover:text-[#3b82f6]">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8A2.999 2.999 0 0112 14v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-9c0-1.105.895-2 2-2h4l2 2m0 0l-2-2"></path></svg>
                    Trade
                </a>
                <a href="#" onclick="showSection('funds'); return false;" class="sidebar-link hover:text-[#3b82f6]">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                    Funds
                </a>
                <a href="#" onclick="showSection('profile'); return false;" class="sidebar-link hover:text-[#3b82f6]">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    Profile
                </a>
                
                <div class="h-px bg-gray-700 my-4"></div>
                
                <a href="#" onclick="showSection('contact'); return false;" class="sidebar-link text-sm text-gray-400 hover:text-white">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26c.71.47 1.69.47 2.4 0L21 8M3 19h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                    Contact Us
                </a>
                <a href="#" onclick="showSection('about'); return false;" class="sidebar-link text-sm text-gray-400 hover:text-white">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    About us
                </a>
                <a href="#" onclick="showSection('ticket'); return false;" class="sidebar-link text-sm text-gray-400 hover:text-white">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    Raise a ticket
                </a>
                <a href="#" onclick="showSection('faq'); return false;" class="sidebar-link text-sm text-gray-400 hover:text-white">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9.247a3 3 0 100-5.775 3 3 0 000 5.775zm3.743-4.14a4 4 0 01-6.142-.258c-.89 1.437-.301 3.25.86 4.195a.5.5 0 00.707-.707c-1.39-1.39-1.25-3.66.365-4.885 1.615-1.226 3.864-1.226 5.479 0zM12 21a9 9 0 100-18 9 9 0 000 18z"></path></svg>
                    FAQ
                </a>
            </nav>

            <!-- Footer/Version -->
            <div class="mt-auto pt-4 border-t border-gray-700 text-center">
                <p class="text-xs text-gray-500">CDX Platform v2025.06</p>
            </div>
        </div>
    </aside>

    <!-- Overlay for closing sidebar when clicking outside -->
    <div id="sidebar-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-40 transition-opacity duration-300 opacity-0 pointer-events-none sidebar-overlay"></div>

    <div class="main-container flex flex-col">
        <!-- HEADER (Top Bar - Mobile Focused) -->
        <header class="bg-[#181a20] shadow-lg sticky top-0 z-30">
            <div class="max-w-xl mx-auto px-4">
                <div class="flex justify-between items-center h-12">
                    <!-- Left Side: Menu and App Name (CDX) -->
                    <div class="flex items-center">
                        <!-- HAMBURGER MENU BUTTON -->
                        <button onclick="toggleSidebar()" class="text-white hover:text-[#3b82f6] transition duration-150 mr-3">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                        </button>
                        <!-- Updated: CDX App Name is always visible now -->
                        <span class="text-xl font-extrabold text-[#3b82f6]">CDX</span>
                    </div>

                    <!-- Right Side: User and Notifications -->
                    <div class="flex items-center space-x-3">
                        <span class="text-xs font-semibold text-gray-300">vishaal</span>
                        <!-- Profile Icon (User) -->
                        <button data-section="profile" class="nav-link bg-[#3b82f6] rounded-full p-1.5 focus:outline-none" onclick="showSection('profile', false)">
                            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- MAIN CONTENT AREA (Mobile Padding) -->
        <main class="flex-grow p-3 max-w-xl mx-auto w-full">

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 1: HOME DASHBOARD (Compact) -->
            <!-- ---------------------------------------------------- -->
            <section id="home-section" class="main-section space-y-4">
                <h1 class="text-xl font-bold text-white">Dashboard Overview</h1>

                <!-- Summary Grid (Very Compact) -->
                <div class="grid grid-cols-3 gap-2">
                    <!-- Total Invested -->
                    <div class="card p-3">
                        <p class="text-xs text-gray-400">Invested (INR)</p>
                        <p class="text-lg font-extrabold text-white mt-0.5">₹98.3k</p>
                    </div>
                    <!-- Current Value -->
                    <div class="card p-3">
                        <p class="text-xs text-gray-400">Current Value</p>
                        <p class="text-lg font-extrabold text-white mt-0.5">₹14.9k</p>
                    </div>
                    <!-- Overall P&L -->
                    <div class="card p-3">
                        <p class="text-xs text-gray-400">P&L (%)</p>
                        <p class="text-lg font-extrabold text-accent-red mt-0.5">-84.80%</p>
                    </div>
                </div>

                <!-- Market Watch List -->
                <div class="card p-4">
                    <!-- The (10 Coins) text remains removed as per the earlier instruction -->
                    <h2 class="text-lg font-bold mb-3 text-white">Live Market Prices</h2>
                    
                    <!-- Coin Search Input -->
                    <input type="search" id="coin-search" onkeyup="filterMarketWatch()" placeholder="Search coins (e.g., BTC, DOGE)..." 
                           class="w-full bg-[#181a20] border border-gray-600 rounded-md p-2 text-sm text-white mb-3 focus:ring-[#3b82f6] focus:border-[#3b82f6]">

                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-700 text-sm">
                            <thead class="bg-[#2c2f3a]">
                                <tr>
                                    <th class="px-2 py-2 text-left text-xs font-medium text-gray-400 uppercase">Coin</th>
                                    <th class="px-2 py-2 text-right text-xs font-medium text-gray-400 uppercase">Price (INR)</th>
                                    <th class="px-2 py-2 text-right text-xs font-medium text-gray-400 uppercase">24h Change</th>
                                    <th class="px-2 py-2 text-center text-xs font-medium text-gray-400 uppercase">Trade</th>
                                </tr>
                            </thead>
                            <tbody id="market-watch-body" class="divide-y divide-gray-800">
                                <!-- Coin rows will be generated by JS on load -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Investment Holdings List (Mobile Grid) -->
                <div class="card p-4">
                    <h2 class="text-lg font-bold mb-3 text-white">My Holdings P&L</h2>
                    <div class="grid grid-cols-2 gap-3">
                        <!-- Holding 1: BTC -->
                        <div class="bg-[#181a20] p-3 rounded-lg">
                            <p class="font-semibold text-sm text-white">BTC</p>
                            <p class="text-xs text-gray-400">Invested: 25.1k</p>
                            <p class="font-bold text-accent-red text-sm mt-1">-79.36%</p>
                        </div>
                        <!-- Holding 2: NOT -->
                        <div class="bg-[#181a20] p-3 rounded-lg">
                            <p class="font-semibold text-sm text-white">NOT</p>
                            <p class="text-xs text-gray-400">Invested: 15.0k</p>
                            <p class="font-bold text-accent-red text-sm mt-1">-96.67%</p>
                        </div>
                        <!-- Holding 3: ETH -->
                        <div class="bg-[#181a20] p-3 rounded-lg">
                            <p class="font-semibold text-sm text-white">ETH</p>
                            <p class="text-xs text-gray-400">Invested: 19.8k</p>
                            <p class="font-bold text-accent-red text-sm mt-1">-84.18%</p>
                        </div>
                        <!-- Holding 4: Placeholder for more -->
                        <div class="bg-[#181a20] p-3 rounded-lg flex items-center justify-center">
                             <button class="text-xs font-semibold text-[#3b82f6]" onclick="showSection('funds', false)">View All (6) →</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 2: TRADE INTERFACE (Mobile Focused) -->
            <!-- ---------------------------------------------------- -->
            <section id="trade-section" class="main-section hidden space-y-4">
                <h1 class="text-xl font-bold text-white"><span id="trade-pair-title">BTC/INR</span> Trading</h1>

                <div class="grid grid-cols-1 gap-4">

                    <!-- Chart & Price Info -->
                    <div>
                        <!-- Current Price & 24h Data (Compact) -->
                        <div class="card p-3 mb-4">
                            <div class="flex justify-between items-center">
                                <div>
                                    <!-- UPDATED PRICE HERE -->
                                    <p class="text-lg font-bold text-accent-red"><span id="current-price">83,10,764.00</span> INR</p>
                                    <p class="text-xs text-gray-400" id="pair-subtitle">BTC/INR</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm font-semibold text-accent-red">24H: -1.45%</p>
                                    <p class="text-xs text-gray-500">Vol: 10.5B</p>
                                </div>
                            </div>
                        </div>

                        <!-- Running Chart Canvas (Static Line Chart Demo) -->
                        <div class="chart-frame">
                            <div class="flex justify-between text-xs text-gray-400 p-1">
                                <span class="font-semibold text-white">1H Price Chart</span>
                            </div>
                            <canvas id="btc-chart"></canvas>
                        </div>
                    </div>

                    <!-- Trade Panel (Order Placing & Order Book - Stacked) -->
                    <div class="space-y-4">
                        <!-- Order Placing Form -->
                        <div class="card p-4">
                            <!-- Buy/Sell Tabs -->
                            <div class="flex space-x-2 mb-4">
                                <button id="buy-tab" class="flex-1 py-2 text-sm rounded-md bg-accent-green/20 text-accent-green font-semibold border border-accent-green" onclick="setTradeMode('buy')">BUY</button>
                                <button id="sell-tab" class="flex-1 py-2 text-sm rounded-md bg-accent-red/20 text-accent-red font-semibold border border-accent-red" onclick="setTradeMode('sell')">SELL</button>
                            </div>

                            <!-- Limit/Market Tabs -->
                            <div class="flex mb-4 rounded-md bg-[#181a20] p-1">
                                <button id="limit-order-tab" class="trade-order-tab flex-1 py-1 text-xs font-medium text-gray-400 rounded-md trade-tab-active" onclick="setOrderType('limit')">Limit</button>
                                <button id="market-order-tab" class="trade-order-tab flex-1 py-1 text-xs font-medium text-gray-400 rounded-md" onclick="setOrderType('market')">Market</button>
                            </div>

                            <form class="space-y-3 text-sm">
                                <div id="limit-price-group">
                                    <label class="block text-xs font-medium text-gray-400">Price (INR)</label>
                                    <!-- UPDATED DEFAULT INPUT PRICE HERE -->
                                    <input type="text" value="83,10,764.00" class="mt-1 block w-full bg-[#181a20] border border-gray-600 rounded-md p-2 text-white focus:ring-[#3b82f6] focus:border-[#3b82f6]">
                                </div>
                                <div id="market-price-group" class="hidden">
                                    <label class="block text-xs font-medium text-gray-400">Price</label>
                                    <div class="mt-1 block w-full bg-[#181a20]/50 border border-gray-700 rounded-md p-2 text-white text-xs opacity-70">Market Price (Instant)</div>
                                </div>
                                
                                <div>
                                    <label class="block text-xs font-medium text-gray-400">Amount (<span id="trade-coin-label">BTC</span>)</label>
                                    <input type="number" placeholder="0.00" class="mt-1 block w-full bg-[#181a20] border border-gray-600 rounded-md p-2 text-white focus:ring-[#3b82f6] focus:border-[#3b82f6]">
                                </div>
                                <p class="text-xs text-gray-500 pt-1">Available: ₹13.76 INR</p>

                                <button id="trade-submit-button" type="submit" class="w-full py-2.5 text-sm trade-button-buy rounded-md font-bold text-white shadow-lg hover:shadow-green-500/50 transition duration-300">
                                    Place Buy Limit Order
                                </button>
                            </form>
                        </div>

                        <!-- Order Book Mockup -->
                        <div class="card p-3">
                            <h3 class="text-sm font-bold mb-2 text-white">Order Book</h3>
                            <div class="flex text-xs font-mono">
                                <!-- Mock Sell Side -->
                                <div class="w-1/2 pr-1 space-y-0.5">
                                    <p class="text-gray-400">Price (INR)</p>
                                    <div class="flex justify-between text-accent-red/80"><p>83,10,800</p><p>1.25 BTC</p></div>
                                    <div class="flex justify-between text-accent-red/70"><p>83,10,900</p><p>2.10 BTC</p></div>
                                    <div class="flex justify-between text-accent-red/60"><p>83,11,000</p><p>0.88 BTC</p></div>
                                </div>
                                <!-- Mock Buy Side -->
                                <div class="w-1/2 pl-1 space-y-0.5 text-right">
                                    <p class="text-gray-400">Amount (BTC)</p>
                                    <div class="flex justify-between text-accent-green/80"><p>1.50 BTC</p><p>83,10,700</p></div>
                                    <div class="flex justify-between text-accent-green/70"><p>0.95 BTC</p><p>83,10,600</p></div>
                                    <div class="flex justify-between text-accent-green/60"><p>2.00 BTC</p><p>83,10,500</p></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 3: FUNDS AND ASSETS (Compact) -->
            <!-- ---------------------------------------------------- -->
            <section id="funds-section" class="main-section hidden space-y-4">
                <h1 class="text-xl font-bold text-white">My Funds & Assets</h1>

                <!-- Fund Summary -->
                <div class="card p-4">
                    <p class="text-xs text-gray-400">Total Account Value (Assets + Cash)</p>
                    <p class="text-3xl font-extrabold text-[#3b82f6] mt-1">₹14,981.86</p> <!-- UPDATED VALUE -->
                    <div class="mt-3 pt-3 border-t border-gray-700">
                        <div class="flex justify-between items-center mb-4">
                            <div>
                                <p class="text-xs text-gray-400">Available INR Balance</p>
                                <!-- BALANCE UPDATED HERE -->
                                <p class="text-lg font-bold text-white">₹13.76</p>
                            </div>
                        </div>
                        <!-- Deposit/Withdraw Buttons -->
                        <div class="flex space-x-3">
                            <button class="flex-1 py-2 text-sm bg-accent-green hover:bg-emerald-600 rounded-md font-semibold text-white">Deposit</button>
                            <button class="flex-1 py-2 text-sm bg-accent-red hover:bg-red-600 rounded-md font-semibold text-white">Withdraw</button>
                        </div>
                    </div>
                </div>
                
                <!-- New Transaction History Card -->
                <div class="card p-4">
                    <h2 class="text-lg font-bold mb-3 text-white">Transaction History (INR)</h2>
                    
                    <div class="space-y-4 text-sm">
                        <!-- Transaction 1: Deposit -->
                        <div class="border-b border-gray-700/50 pb-2">
                            <div class="flex justify-between items-center">
                                <span class="font-medium text-accent-green">Deposit Successful</span>
                                <span class="text-white font-semibold">₹49,300.00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs text-gray-400">
                                 <span>Date: 17.02.2025</span>
                                 <span>(49.3k)</span>
                            </div>
                        </div>

                        <!-- Transaction 2: Deposit -->
                        <div class="border-b border-gray-700/50 pb-2">
                            <div class="flex justify-between items-center">
                                <span class="font-medium text-accent-green">Deposit Successful</span>
                                <span class="text-white font-semibold">₹49,300.00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs text-gray-400">
                                 <span>Date: 06.03.2025</span>
                                 <span>(49.3k)</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Withdrawal Note -->
                    <p class="text-xs text-gray-500 italic mt-5 text-center pt-3 border-t border-gray-700">
                        Note: No withdrawals have been recorded yet.
                    </p>
                </div>

                <!-- Detailed Investment Table -->
                <div class="card p-4">
                    <h2 class="text-lg font-bold mb-3 text-white">Investment Holdings (6)</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-700 text-sm">
                            <thead class="bg-[#2c2f3a]">
                                <tr>
                                    <th class="px-2 py-2 text-left text-xs font-medium text-gray-400 uppercase">Coin</th>
                                    <th class="px-2 py-2 text-right text-xs font-medium text-gray-400 uppercase">Invested</th>
                                    <th class="px-2 py-2 text-right text-xs font-medium text-gray-400 uppercase">Current</th>
                                    <th class="px-2 py-2 text-right text-xs font-medium text-gray-400 uppercase">P&L (%)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-800">
                                <!-- Data has been updated with non-zero decimal places and subtle changes -->
                                <tr class="hover:bg-[#2c2f3a]"><td class="px-2 py-2 font-medium text-white">BTC</td><td class="px-2 py-2 text-right">25,123.45</td><td class="px-2 py-2 text-right">5,188.99</td><td class="px-2 py-2 text-right font-semibold text-accent-red">-79.36%</td></tr>
                                <tr class="hover:bg-[#2c2f3a]"><td class="px-2 py-2 font-medium text-white">ETH</td><td class="px-2 py-2 text-right">19,876.54</td><td class="px-2 py-2 text-right">3,145.22</td><td class="px-2 py-2 text-right font-semibold text-accent-red">-84.18%</td></tr>
                                <tr class="hover:bg-[#2c2f3a]"><td class="px-2 py-2 font-medium text-white">NOT</td><td class="px-2 py-2 text-right">15,050.11</td><td class="px-2 py-2 text-right">501.78</td><td class="px-2 py-2 text-right font-extrabold text-accent-red">-96.67%</td></tr>
                                <tr class="hover:bg-[#2c2f3a]"><td class="px-2 py-2 text-right">MATIC</td><td class="px-2 py-2 text-right">16,401.95</td><td class="px-2 py-2 text-right">4,210.30</td><td class="px-2 py-2 text-right font-semibold text-accent-red">-74.33%</td></tr>
                                <tr class="hover:bg-[#2c2f3a]"><td class="px-2 py-2 font-medium text-white">SOL</td><td class="px-2 py-2 text-right">11,920.80</td><td class="px-2 py-2 text-right">1,311.66</td><td class="px-2 py-2 text-right font-semibold text-accent-red">-89.02%</td></tr>
                                <tr class="hover:bg-[#2c2f3a]"><td class="px-2 py-2 font-medium text-white">DOGE</td><td class="px-2 py-2 text-right">9,950.05</td><td class="px-2 py-2 text-right">610.15</td><td class="px-2 py-2 text-right font-semibold text-accent-red">-93.87%</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 4: PROFILE & SETTINGS (Compact) -->
            <!-- ---------------------------------------------------- -->
            <section id="profile-section" class="main-section hidden space-y-4">
                <h1 class="text-xl font-bold text-white">Account Settings</h1>

                <!-- Profile Card -->
                <div class="card p-4 text-sm">
                    <h2 class="text-lg font-bold mb-3 text-white">Personal Information</h2>
                    <div class="space-y-3">
                        <div class="flex justify-between border-b border-gray-700 pb-2">
                            <span class="text-gray-400">User ID</span>
                            <span class="font-semibold text-white">vishaal</span>
                        </div>
                        <div class="flex justify-between border-b border-gray-700 pb-2">
                            <span class="text-gray-400">Email Status</span>
                            <span class="font-semibold text-accent-green">Verified</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Account Status</span>
                            <span class="font-semibold text-accent-green">Active (Full Access)</span>
                        </div>
                    </div>
                </div>

                <!-- Security Settings -->
                <div class="card p-4 text-sm">
                    <h2 class="text-lg font-bold mb-3 text-white">Security & Access</h2>
                    <div class="space-y-3">
                        <!-- 2FA (Verified) -->
                        <div class="flex justify-between items-center border-b border-gray-700 pb-3">
                            <div>
                                <p class="font-semibold text-white">Two-Factor Auth (2FA)</p>
                                <p class="text-xs text-gray-400">Authenticator app enabled.</p>
                            </div>
                            <button class="py-1 px-3 bg-accent-green hover:bg-emerald-600 rounded-full text-xs font-semibold text-white">Verified</button>
                        </div>
                        <!-- Password -->
                        <div class="flex justify-between items-center border-b border-gray-700 pb-3">
                            <div>
                                <p class="font-semibold text-white">Password Management</p>
                                <p class="text-xs text-gray-400">Last changed 45 days ago.</p>
                            </div>
                            <button class="py-1 px-3 bg-[#3b82f6] hover:bg-blue-600 rounded-md text-xs font-semibold text-white">Change</button>
                        </div>
                        <!-- API Key -->
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="font-semibold text-white">API Key Management</p>
                                <p class="text-xs text-gray-400">Manage keys for trading bots.</p>
                            </div>
                            <button class="py-1 px-3 bg-[#3b82f6] hover:bg-blue-600 rounded-md text-xs font-semibold text-white">Generate Key</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 5: CONTACT US (Updated Phone Number) -->
            <!-- ---------------------------------------------------- -->
            <section id="contact-section" class="main-section hidden space-y-4">
                <h1 class="text-xl font-bold text-white">Contact Us</h1>
                <div class="card p-4 space-y-3">
                    <p class="text-gray-300">Our support team is available 24/7.</p>
                    <p class="text-sm">Email: <span class="font-semibold text-[#3b82f6]">support@cdx.exchange</span></p>
                    <!-- Phone number updated here -->
                    <p class="text-sm">Phone: <span class="font-semibold">0807 4778787</span></p> 
                    <button class="w-full py-2 bg-accent-green rounded-md font-bold text-white mt-4" onclick="showSection('ticket')">Go to Raise a Ticket</button>
                </div>
            </section>

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 6: ABOUT US (New Placeholder) -->
            <!-- ---------------------------------------------------- -->
            <section id="about-section" class="main-section hidden space-y-4">
                <h1 class="text-xl font-bold text-white">About CDX Exchange</h1>
                <div class="card p-4 space-y-3 text-sm">
                    <p class="text-gray-300">CDX is a secure and reliable platform for trading cryptocurrencies in India. We aim to provide the lowest fees and best liquidity.</p>
                    <p class="text-gray-400">Founded: 2022</p>
                    <p class="text-gray-400">Headquarters: Bengaluru, India</p>
                </div>
            </section>

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 7: RAISE A TICKET (New Placeholder) -->
            <!-- ---------------------------------------------------- -->
            <section id="ticket-section" class="main-section hidden space-y-4">
                <h1 class="text-xl font-bold text-white">Raise a Support Ticket</h1>
                <div class="card p-4 space-y-4">
                    <p class="text-gray-300">Fill out the form below for assistance.</p>
                    <input type="text" placeholder="Subject (e.g., Withdrawal issue)" class="w-full bg-[#181a20] border border-gray-600 rounded-md p-2 text-white focus:ring-[#3b82f6] focus:border-[#3b82f6]">
                    <textarea placeholder="Detailed description of your issue..." rows="4" class="w-full bg-[#181a20] border border-gray-600 rounded-md p-2 text-white focus:ring-[#3b82f6] focus:border-[#3b82f6]"></textarea>
                    <button class="w-full py-2 bg-[#3b82f6] rounded-md font-bold text-white">Submit Ticket</button>
                </div>
            </section>

            <!-- ---------------------------------------------------- -->
            <!-- SECTION 8: FAQ (New Placeholder) -->
            <!-- ---------------------------------------------------- -->
            <section id="faq-section" class="main-section hidden space-y-4">
                <h1 class="text-xl font-bold text-white">Frequently Asked Questions (FAQ)</h1>
                <div class="space-y-3">
                    <!-- FAQ 1 -->
                    <div class="card p-3">
                        <p class="font-semibold text-white">Q: How long does INR withdrawal take?</p>
                        <p class="text-sm text-gray-400 mt-1">A: INR withdrawals are typically processed within 30 minutes, but may take up to 24 hours depending on bank processing times.</p>
                    </div>
                    <!-- FAQ 2 -->
                    <div class="card p-3">
                        <p class="font-semibold text-white">Q: What documents are required for KYC?</p>
                        <p class="text-sm text-gray-400 mt-1">A: We require proof of identity (Aadhaar/PAN) and proof of address for full KYC verification.</p>
                    </div>
                </div>
            </section>
            
        </main>

        <!-- MOBILE FOOTER NAVIGATION (Fixed) -->
        <footer class="fixed bottom-0 left-0 right-0 bg-[#181a20] border-t border-gray-700 z-40 h-14">
            <nav class="flex justify-around h-full">
                <!-- IMPORTANT: active-link ensures "Home" is highlighted immediately -->
                <button data-section="home" class="mobile-nav-link active-link flex flex-col items-center justify-center text-xs text-gray-400 hover:text-white transition duration-150">
                    <svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Home
                </button>
                <button data-section="trade" class="mobile-nav-link flex flex-col items-center justify-center text-xs text-gray-400 hover:text-white transition duration-150">
                    <svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8A2.999 2.999 0 0112 14v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-9c0-1.105.895-2 2-2h4l2 2m0 0l-2-2"></path></svg>
                    Trade
                </button>
                <button data-section="funds" class="mobile-nav-link flex flex-col items-center justify-center text-xs text-gray-400 hover:text-white transition duration-150">
                    <svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                    Funds
                </button>
                <button data-section="profile" class="mobile-nav-link flex flex-col items-center justify-center text-xs text-gray-400 hover:text-white transition duration-150">
                    <svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    Profile
                </button>
            </nav>
        </footer>
    </div>

    <!-- JAVASCRIPT FOR SECTION SWITCHING, TRADE LOGIC, SEARCH, AND CHART -->
    <script>
        // --- DATA ---
        let currentTrade = {
            coin: 'BTC',
            mode: 'buy',
            type: 'limit'
        };

        // UPDATED CONSTANTS
        const NEW_BTC_PRICE = 8310764; // New target price
        const OLD_BTC_PRICE = 520450;
        // Recalculated offset: 8310764 - 520450 = 7790314
        const PRICE_OFFSET = NEW_BTC_PRICE - OLD_BTC_PRICE; 

        const priceData = {
            // UPDATED BTC PRICE HERE
            'BTC': { price: '83,10,764.00', change: '-1.45%', color: 'red' }, 
            'ETH': { price: '38,120.50', change: '-0.88%', color: 'red' },
            'NOT': { price: '0.000345', change: '-1.24%', color: 'red' },
            'SOL': { price: '1,250.75', change: '+2.10%', color: 'green' },
            'ADA': { price: '24.11', change: '-3.50%', color: 'red' },
            'XRP': { price: '45.12', change: '+0.55%', color: 'green' },
            'DOGE': { price: '12.89', change: '+4.01%', color: 'green' },
            'BNB': { price: '45,120.00', change: '-2.15%', color: 'red' },
            'AVAX': { price: '2,550.00', change: '+1.11%', color: 'green' },
            'DOT': { price: '550.90', change: '-0.22%', color: 'red' }
        };

        // --- CHART CONSTANTS ---
        const Y_AXIS_WIDTH = 50; 
        const X_AXIS_HEIGHT = 15; 
        const BACKGROUND = '#181a20';
        const GRID_COLOR = 'rgba(255, 255, 255, 0.1)';
        const PRICE_LINE_COLOR = '#ef4444'; 
        const PRICE_AREA_COLOR = 'rgba(239, 68, 68, 0.2)'; 

        const originalPricePoints = [
            525000, 524800, 524000, 523500, 523800, 523900, 523500, 523000, 522500, 522200, 
            521800, 521400, 521000, 520800, 520500, 520300, 520100, 519900, 519500, 519200, 
            519000, 518800, 518500, 518200, 518000, 517800, 517500, 517200, 517000, 517500, 
            518000, 518500, 518800, 519000, 519200, 519500, 519800, 520000, 520300, 520500, 
            520800, 521000, 520800, 520500, 520200, 520000, 520100, 520300, 520500, 520800, 
            520600, 520450, 520300, 520100, 520450, 520650, 520700, 520550, 520450, 520450  
        ];

        const staticPricePoints = originalPricePoints.map(p => p + PRICE_OFFSET);
        
        function generateStaticTimeLabels() {
            const labels = [];
            const now = new Date(); 
            const oneHour = 3600 * 1000;
            
            for (let i = staticPricePoints.length - 1; i >= 0; i--) {
                const timestamp = new Date(now.getTime() - (staticPricePoints.length - 1 - i) * oneHour);
                labels.unshift(timestamp);
            }
            return labels;
        }

        const staticPricePointsWithTime = staticPricePoints.map((price, index) => [generateStaticTimeLabels()[index], price]);

        // --- CHART RENDERING (Static Line Chart) ---

        function drawStaticChart(canvasId, dataPoints) {
            const canvas = document.getElementById(canvasId);
            if (!canvas || !canvas.getContext || dataPoints.length === 0) return;

            const container = canvas.parentNode;
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight - (container.querySelector('div')?.offsetHeight || 0) - 10; 

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const chartHeight = height - X_AXIS_HEIGHT;
            const chartArea = { 
                x: 0, 
                y: 0, 
                w: width - Y_AXIS_WIDTH, 
                h: chartHeight 
            };

            if (chartArea.w <= 0 || chartArea.h <= 0) {
                 ctx.fillStyle = BACKGROUND;
                 ctx.fillRect(0, 0, width, height);
                 return;
            }

            ctx.fillStyle = BACKGROUND;
            ctx.fillRect(0, 0, width, height);

            const prices = dataPoints.map(p => p[1]);
            let maxPrice = Math.max(...prices);
            let minPrice = Math.min(...prices);

            const priceBuffer = (maxPrice - minPrice) * 0.05;
            maxPrice += priceBuffer;
            minPrice -= priceBuffer;
            const priceRange = maxPrice - minPrice;

            const priceToY = (price) => {
                const normalizedPrice = (price - minPrice) / (priceRange || 1);
                return chartArea.h - (normalizedPrice * chartArea.h);
            };

            // 2. Draw Grid Lines (Y-Axis)
            ctx.strokeStyle = GRID_COLOR;
            ctx.lineWidth = 1;
            ctx.setLineDash([2, 2]);

            for (let i = 1; i <= 3; i++) {
                const price = minPrice + (priceRange / 4) * i;
                const y = priceToY(price);
                
                ctx.beginPath();
                ctx.moveTo(chartArea.x, y);
                ctx.lineTo(chartArea.x + chartArea.w, y);
                ctx.stroke();

                ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
                ctx.font = '9px Inter';
                ctx.textAlign = 'left';
                
                const priceValue = price;
                let label;
                if (priceValue >= 1000000) { 
                    label = (priceValue / 1000000).toFixed(2) + 'M';
                } else if (priceValue >= 1000) { 
                    label = (priceValue / 1000).toFixed(0) + 'K';
                } else {
                    label = priceValue.toFixed(2);
                }
                
                ctx.fillText(label, chartArea.w + 5, y + 3);
            }
            ctx.setLineDash([]); 

            // 3. Draw Price Line and Area Fill
            ctx.beginPath();
            
            ctx.moveTo(chartArea.x, priceToY(dataPoints[0][1]));

            const totalPointWidth = chartArea.w / dataPoints.length;

            dataPoints.forEach(([timestamp, price], index) => {
                const xCenter = index * totalPointWidth + totalPointWidth / 2;
                const y = priceToY(price);
                
                if (index === 0) {
                    ctx.lineTo(xCenter, y);
                } else {
                    ctx.lineTo(xCenter, y);
                }
            });

            const lastX = chartArea.w - totalPointWidth / 2;
            const startY = priceToY(dataPoints[0][1]);
            const endY = chartArea.h;

            ctx.lineTo(lastX, endY);
            ctx.lineTo(0, endY);
            ctx.lineTo(0, startY);
            ctx.closePath();

            const gradient = ctx.createLinearGradient(0, 0, 0, chartArea.h);
            gradient.addColorStop(0, PRICE_AREA_COLOR);
            gradient.addColorStop(1, BACKGROUND);
            ctx.fillStyle = gradient;
            ctx.fill();


            ctx.beginPath();
            ctx.strokeStyle = PRICE_LINE_COLOR;
            ctx.lineWidth = 2; 
            
            dataPoints.forEach(([timestamp, price], index) => {
                const xCenter = index * totalPointWidth + totalPointWidth / 2;
                const y = priceToY(price);
                
                if (index === 0) {
                    ctx.moveTo(xCenter, y);
                } else {
                    ctx.lineTo(xCenter, y);
                }
            });
            ctx.stroke();

            // 4. Draw Time Axis (X-Axis)
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.font = '8px Inter';
            ctx.textAlign = 'center';
            
            const labelInterval = 10;
            for (let i = 0; i < dataPoints.length; i++) {
                if (i % labelInterval === 0 || i === dataPoints.length - 1) {
                    const [timestamp] = dataPoints[i];
                    const date = new Date(timestamp);
                    const hours = date.getHours();
                    const period = hours >= 12 ? 'pm' : 'am';
                    const displayHour = hours % 12 || 12;
                    const minutes = date.getMinutes().toString().padStart(2, '0');

                    const timeLabel = displayHour + ':' + minutes + period;
                    
                    const xCenter = i * totalPointWidth + totalPointWidth / 2;
                    
                    ctx.fillText(timeLabel, xCenter, chartArea.h + 10);
                }
            }

            ctx.strokeStyle = '#2d303a';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, chartArea.h);
            ctx.lineTo(width, chartArea.h);
            ctx.stroke();
        }

        // --- SIDEBAR TOGGLE ---
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar-menu');
            const overlay = document.getElementById('sidebar-overlay');
            const isOpen = sidebar.classList.contains('open');

            if (isOpen) {
                sidebar.classList.remove('open');
                overlay.classList.add('opacity-0', 'pointer-events-none');
                overlay.classList.remove('opacity-100', 'pointer-events-auto');
            } else {
                sidebar.classList.add('open');
                overlay.classList.remove('opacity-0', 'pointer-events-none');
                overlay.classList.add('opacity-100', 'pointer-events-auto');
            }
        }


        // --- CORE NAVIGATION ---
        function showSection(sectionId, shouldCloseSidebar = true) {
            const sections = document.querySelectorAll('.main-section');
            const navLinks = document.querySelectorAll('.mobile-nav-link');

            sections.forEach(section => {
                section.classList.add('hidden');
            });

            const activeSection = document.getElementById(sectionId + '-section');
            if (activeSection) {
                activeSection.classList.remove('hidden');
            }

            // Only update the fixed footer nav highlights for the main 4 sections
            if (['home', 'trade', 'funds', 'profile'].includes(sectionId)) {
                navLinks.forEach(link => {
                    link.classList.remove('active-link');
                    if (link.dataset.section === sectionId) {
                        link.classList.add('active-link');
                    }
                });
            } else {
                 // Clear highlights if we navigate to an auxiliary page
                 navLinks.forEach(link => link.classList.remove('active-link'));
            }


            // Draw the chart only when the trade section is shown and the pair is BTC
            if (sectionId === 'trade' && currentTrade.coin === 'BTC') {
                // Ensure chart is drawn only if the canvas element exists
                if (document.getElementById('btc-chart')) {
                    drawStaticChart('btc-chart', staticPricePointsWithTime);
                }
            }
             // Draw the chart if the section is 'home' (since the mini-chart is on the home page)
            if (sectionId === 'home') {
                 // The home page doesn't have the chart, so nothing to draw
            }


            if (shouldCloseSidebar) {
                toggleSidebar();
            }
        }

        // --- MARKET WATCH & SEARCH ---
        function renderMarketWatch() {
            const tbody = document.getElementById('market-watch-body');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            Object.keys(priceData).forEach(coin => {
                const data = priceData[coin];
                const row = document.createElement('tr');
                row.className = 'hover:bg-[#2c2f3a] transition duration-150 coin-row';
                row.dataset.coin = coin;

                const changeClass = data.color === 'green' ? 'text-accent-green' : 'text-accent-red';

                row.innerHTML = `
                    <td class="px-2 py-2 font-semibold text-white">${coin}</td>
                    <td class="px-2 py-2 text-right">${data.price}</td>
                    <td class="px-2 py-2 text-right font-semibold ${changeClass}">${data.change}</td>
                    <td class="px-2 py-2 text-center">
                        <button class="text-xs font-bold text-[#3b82f6] hover:text-white" onclick="showSection('trade', false); updateTradePair('${coin}')">TRADE</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterMarketWatch() {
            const input = document.getElementById('coin-search');
            const filter = input.value.toUpperCase();
            const rows = document.querySelectorAll('.coin-row');

            rows.forEach(row => {
                const coinSymbol = row.dataset.coin;
                if (coinSymbol && coinSymbol.includes(filter)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // --- TRADE LOGIC (FIXED FOR NULL ERRORS) ---

        function updateTradePair(coin) {
            currentTrade.coin = coin;
            const data = priceData[coin];
            
            // Apply null checks to prevent "Cannot set properties of null" on initialization
            const titleEl = document.getElementById('trade-pair-title');
            if (titleEl) titleEl.textContent = `${coin}/INR`;

            const subtitleEl = document.getElementById('pair-subtitle');
            if (subtitleEl) subtitleEl.textContent = `${coin}/INR`;

            const coinLabelEl = document.getElementById('trade-coin-label');
            if (coinLabelEl) coinLabelEl.textContent = coin;
            
            const currentPriceEl = document.getElementById('current-price');
            if (!currentPriceEl) return; // Exit if the main price element is missing

            currentPriceEl.textContent = data.price || 'N/A';
            
            // Find parent elements for associated info
            const priceEl = currentPriceEl.parentNode?.parentNode;
            if (!priceEl) return; 

            // Query the price container for the sub-elements
            const priceTextEl = priceEl.querySelector('.text-lg'); 
            const changeEl = priceEl.querySelector('.text-sm'); 

            if (changeEl) changeEl.textContent = `24H: ${data.change}`;
            
            if (priceTextEl && changeEl) {
                // Remove previous color classes
                priceTextEl.classList.remove('text-accent-green', 'text-accent-red');
                changeEl.classList.remove('text-accent-green', 'text-accent-red');

                // Apply new color classes
                priceTextEl.classList.add(data.color === 'green' ? 'text-accent-green' : 'text-accent-red');
                changeEl.classList.add(data.color === 'green' ? 'text-accent-green' : 'text-accent-red');
            }


            const limitInput = document.querySelector('#limit-price-group input');
            if (limitInput) {
                limitInput.value = data.price;
            }

            // Chart logic
            if (coin === 'BTC' && document.getElementById('btc-chart')) {
                drawStaticChart('btc-chart', staticPricePointsWithTime);
            } else {
                 const canvas = document.getElementById('btc-chart');
                 if (canvas) {
                    const container = canvas.parentNode;
                    // Reset canvas size based on container
                    canvas.width = container.clientWidth;
                    canvas.height = container.clientHeight - (container.querySelector('div')?.offsetHeight || 0) - 10; 
                    const ctx = canvas.getContext('2d');
                    // Clear canvas
                    ctx.fillStyle = BACKGROUND;
                    ctx.fillRect(0, 0, canvas.width, canvas.height); 
                 }
            }

            updateTradeButton();
        }

        function setTradeMode(mode) {
            currentTrade.mode = mode;
            const buyTab = document.getElementById('buy-tab');
            const sellTab = document.getElementById('sell-tab');

            if (buyTab) {
                buyTab.classList.remove('trade-button-buy', 'text-white', 'border-white');
                buyTab.classList.add('bg-accent-green/20', 'text-accent-green', 'border-accent-green');
            }
            
            if (sellTab) {
                sellTab.classList.remove('trade-button-sell', 'text-white', 'border-white');
                sellTab.classList.add('bg-accent-red/20', 'text-accent-red', 'border-accent-red');
            }

            if (mode === 'buy' && buyTab) {
                buyTab.classList.remove('bg-accent-green/20', 'text-accent-green', 'border-accent-green');
                buyTab.classList.add('trade-button-buy', 'text-white', 'border-white');
            } else if (sellTab) { // sell
                sellTab.classList.remove('bg-accent-red/20', 'text-accent-red', 'border-accent-red');
                sellTab.classList.add('trade-button-sell', 'text-white', 'border-white');
            }
            
            updateTradeButton();
        }

        function setOrderType(type) {
            currentTrade.type = type;
            const limitTab = document.getElementById('limit-order-tab');
            const marketTab = document.getElementById('market-order-tab');
            const limitGroup = document.getElementById('limit-price-group');
            const marketGroup = document.getElementById('market-price-group');

            if (limitTab) {
                limitTab.classList.remove('trade-tab-active', 'text-white');
                limitTab.classList.add('text-gray-400');
            }
            if (marketTab) {
                marketTab.classList.remove('trade-tab-active', 'text-white');
                marketTab.classList.add('text-gray-400');
            }


            if (type === 'limit') {
                if (limitTab) {
                    limitTab.classList.add('trade-tab-active');
                    limitTab.classList.remove('text-gray-400');
                }
                if (limitGroup) limitGroup.classList.remove('hidden');
                if (marketGroup) marketGroup.classList.add('hidden');
            } else { // market
                if (marketTab) {
                    marketTab.classList.add('trade-tab-active');
                    marketTab.classList.remove('text-gray-400');
                }
                if (limitGroup) limitGroup.classList.add('hidden');
                if (marketGroup) marketGroup.classList.remove('hidden');
            }

            updateTradeButton();
        }

        function updateTradeButton() {
            const button = document.getElementById('trade-submit-button');
            if (!button) return; 

            const modeText = currentTrade.mode === 'buy' ? 'Buy' : 'Sell';
            const typeText = currentTrade.type === 'limit' ? 'Limit' : 'Market';

            button.textContent = `Place ${modeText} ${typeText} Order`;

            button.classList.remove('trade-button-buy', 'trade-button-sell', 'hover:shadow-green-500/50', 'hover:shadow-red-500/50');
            
            if (currentTrade.mode === 'buy') {
                button.classList.add('trade-button-buy', 'hover:shadow-green-500/50');
            } else {
                button.classList.add('trade-button-sell', 'hover:shadow-red-500/50');
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Render all 10 coins into the table
            renderMarketWatch();

            // 2. Initial navigation setup for footer links
            const navLinks = document.querySelectorAll('.mobile-nav-link');
            
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetSection = link.dataset.section;
                    // Note: showSection handles closing the sidebar if it was open
                    showSection(targetSection, false); 
                });
            });

            // 3. Set initial trade state display for Trade section
            // These calls ensure the trade panel looks correct when Trade is first clicked
            updateTradePair('BTC');
            setTradeMode('buy');
            setOrderType('limit');

            // 4. Initial view: Show the Home section and activate its link
            showSection('home', false);
        });

        // Handle resize for chart canvas - must redraw static chart on resize
        window.addEventListener('resize', () => {
             // Redraw the static chart if the trade section is visible and BTC is selected
             const tradeSection = document.getElementById('trade-section');
             if (tradeSection && !tradeSection.classList.contains('hidden') && currentTrade.coin === 'BTC') {
                if (document.getElementById('btc-chart')) {
                    drawStaticChart('btc-chart', staticPricePointsWithTime);
                }
             }
        });
    </script>
</body>
</html>